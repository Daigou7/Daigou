<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Kaguya Adventure</title>
    <style>
        body { margin: 0; background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; font-family: 'Courier New', Courier, monospace; }
        canvas { background: #5c94fc; border: 4px solid #fff; image-rendering: pixelated; }
        .ui { position: absolute; top: 20px; color: white; text-align: center; width: 100%; pointer-events: none; text-shadow: 2px 2px #000; }
    </style>
</head>
<body>
    <div class="ui">
        <h1>KAGUYA WORLD</h1>
        <p>Setas para mover | Espaço para pular</p>
    </div>
    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    canvas.width = 800;
    canvas.height = 400;

    const gravity = 0.6;
    const friction = 0.8;
    let keys = [];

    let player = {
        x: 100,
        y: 300,
        width: 30,
        height: 45,
        speed: 5,
        velX: 0,
        velY: 0,
        jumping: false,
        grounded: false
    };

    const platforms = [
        { x: 0, y: 370, width: 800, height: 30 }, // Chão
        { x: 300, y: 270, width: 120, height: 20 },
        { x: 500, y: 190, width: 120, height: 20 },
        { x: 150, y: 180, width: 100, height: 20 },
        { x: 650, y: 280, width: 100, height: 20 }
    ];

    function drawKaguya() {
        // Cabelo de trás
        ctx.fillStyle = "#1a1a1a";
        ctx.fillRect(player.x - 2, player.y + 5, player.width + 4, 25);
        
        // Vestido (Preto)
        ctx.fillStyle = "#000";
        ctx.fillRect(player.x, player.y + 15, player.width, player.height - 15);
        
        // Rosto
        ctx.fillStyle = "#ffe0bd";
        ctx.fillRect(player.x + 5, player.y, player.width - 10, 20);

        // Olhos (Vermelhos)
        ctx.fillStyle = "#ff0000";
        ctx.fillRect(player.x + 8, player.y + 8, 4, 4);
        ctx.fillRect(player.x + 18, player.y + 8, 4, 4);

        // Laço Vermelho
        ctx.fillStyle = "#be0000";
        ctx.fillRect(player.x + 10, player.y - 5, 10, 8);
    }

    function update() {
        // Movimentos
        if (keys[38] || keys[32] || keys[87]) { // Pulo
            if (!player.jumping && player.grounded) {
                player.jumping = true;
                player.grounded = false;
                player.velY = -player.speed * 2.5;
            }
        }
        if (keys[39] || keys[68]) { // Direita
            if (player.velX < player.speed) player.velX++;
        }
        if (keys[37] || keys[65]) { // Esquerda
            if (player.velX > -player.speed) player.velX--;
        }

        player.velX *= friction;
        player.velY += gravity;

        player.grounded = false;

        // Desenhar Chão e Plataformas
        ctx.fillStyle = "#8b4513";
        for (let i = 0; i < platforms.length; i++) {
            ctx.fillRect(platforms[i].x, platforms[i].y, platforms[i].width, platforms[i].height);
            
            // Colisão
            let dir = colCheck(player, platforms[i]);
            if (dir === "l" || dir === "r") {
                player.velX = 0;
            } else if (dir === "b") {
                player.grounded = true;
                player.jumping = false;
            } else if (dir === "t") {
                player.velY *= -1;
            }
        }

        if (player.grounded) {
            player.velY = 0;
        }

        player.x += player.velX;
        player.y += player.velY;

        // Limite de tela
        if (player.x >= canvas.width - player.width) player.x = canvas.width - player.width;
        else if (player.x <= 0) player.x = 0;

        drawKaguya();
    }

    function colCheck(shapeA, shapeB) {
        let vX = (shapeA.x + (shapeA.width / 2)) - (shapeB.x + (shapeB.width / 2)),
            vY = (shapeA.y + (shapeA.height / 2)) - (shapeB.y + (shapeB.height / 2)),
            hWidths = (shapeA.width / 2) + (shapeB.width / 2),
            hHeights = (shapeA.height / 2) + (shapeB.height / 2),
            colDir = null;

        if (Math.abs(vX) < hWidths && Math.abs(vY) < hHeights) {
            let oX = hWidths - Math.abs(vX),
                oY = hHeights - Math.abs(vY);
            if (oX >= oY) {
                if (vY > 0) {
                    colDir = "t";
                    shapeA.y += oY;
                } else {
                    colDir = "b";
                    shapeA.y -= oY;
                }
            } else {
                if (vX > 0) {
                    colDir = "l";
                    shapeA.x += oX;
                } else {
                    colDir = "r";
                    shapeA.x -= oX;
                }
            }
        }
        return colDir;
    }

    function loop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        update();
        requestAnimationFrame(loop);
    }

    window.addEventListener("keydown", function (e) { keys[e.keyCode] = true; });
    window.addEventListener("keyup", function (e) { keys[e.keyCode] = false; });

    loop();
</script>
</body>
</html>
